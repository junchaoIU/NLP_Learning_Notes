# KBQA（知识库问答）

## 1 基于词典和规则

### 1.1 简介

依托于通用知识图谱或领域知识图谱所构建的知识库及其制定的规则（实体类别、关系类别、属性类别、上下级关系等）构建的KBQA知识库问答

### 1.2 思路

（1）输入句子（问句）

（2）问句解析

1. 实体抽取

- 为什么：得到匹配的实体及其类型
- 方法：
  - 规则匹配：正则表达式
  - 词典：trie和Aho-Corasick自动机，简称AC自动机（ahocorasick、FlashText 等 python包）
  - 基于词向量的文本相似度计算：词向量工具（TF-idf、word2vec、Bert 等）、相似度计算方法（余弦相似度、L1、L2等）
  - 命名实体识别方法：BiLSTM-CRF等命名实体识别模型

2. 关系及属性抽取

- 为什么：抽取问句中的属性和关系
- 方法：
  - 规则匹配：正则表达式
  - 词典：trie和Aho-Corasick自动机，简称AC自动机（ahocorasick、FlashText 等 python包）
  - 意图识别：采用机器学习（LR、SVM、NB）或深度学习（TextCNN、TextRNN、Bert）分类模型对问句中所含关系做预测
  - 命名实体识别：BiLSTM-CRF等命名实体识别模型

（3）查询语句的生成

- 原理：根据实体抽取和关系&属性抽取的结果，将 实体、属性和关系转化为查询语句，如RDFS为SPARQL语句，Neo4j为Cypher

（4）知识库检索并生成结果

- 原理：利用查询语句的生成的结果，去TDB数据库或图数据库中查询答案，并利用**预设模板**生成答案



## 2 基于信息抽取

### 2.1 思路

（1）分类单跳和多跳问句

- 原理：通过文本分类对问句进行分类，判断其属于一跳问题还是多跳问题（单跳：SPARQL只出现一个三元组 ，双跳或多跳：SPARQL 只出现两个以上三元组）
- 方法：
  - 文本分类方法（TextCNN、TextRNN、Bert 等）

（2）分类链式问句（二分类）

- 原理：通过文本分类对问句进行分类，判断其是否属于链式问句（链式问句：SPARQL 多个三元组呈递进关系，x->y->z，非交集关系）

（3）主谓宾分类（三分类）

- 原理：利用 文本分类方法对问句进行分类，判断问句的答案对应三元组里面的 主谓宾。根据要检索的目标，并生成检索语言。分为如下三类：问句的答案对应三元组里面的主语；问句的答案对应三元组里面的谓语；问句的答案对应三元组里面的宾语

（4）实体匹配（识别）

- 原理：识别出问句中所含有的实体，并对齐到知识库中的具体实体
- 方法：
  - 命名实体识别：训练 命名实体识别模型 抽取 未标注数据 中 实体信息（现成语言平台or汉语言处理包；神经网络：BiLSTM-CRF、Bert-CRF 等）
  - 构建语料库，并与知识库实体进行映射or对齐

（5）关系分类

- 原理：查询抽取出的问句中的实体关系与实体关系中最相似的一个（语义相似度计算，二分类问题）

（6）实体消歧

- 原理：查找问句中真正指代的实体，消除同名带来的实体指代错误

- 方法：

  - 规则内的实体语义定义
  - 机器学习（分类模型：LR、SVM、xgboost等，标签：是否为对应实体）
    - 问题和实体提及间 特征 mention_features
      - 实体提及的长度：该实体对应的实体提及的字数；
      - 实体提及的词频：该实体对应的实体提及的词频；
      - 实体提及的位置：该实体对应的实体提及距离句首的距离；
      - 实体类型与问题的匹配度
    - 图谱子图与问题的匹配度：计算问题和主语实体及其两跳内关系间的相似度
      - 实体提及及两跳内关系和实体与问题重叠词数量
      - 实体提及及两跳内关系和实体与问题重叠字数量
    - 实体提及的流行度特征
      - 实体提及在图谱中关系个数/出现频率
    - 实体名称和问题的字符串匹配度(char/word)
    - 问题和实体提及语义相似度
    - 问题和实体关系的最大相似度 ...

  （7）候选查询路径生成及文本匹配

  - 原理：将得到的实体和关系拼凑成自然语言能理解的形式，并判断所抽取的实体和关系是否正确
  - 方法：
    - 将 （entity，relation） 转化成 自然语言处理 能够处理的 文本形式：eg ： entity 的 relation
    - 文本匹配：利用 Bert 计算问句和 entity 的 relation 的相似度（在训练集上，对于每个问题，随机选择三个候选查询路径作为负例，令标注的候选查询路径标签为1，负例的标签为0，将自然语言问题和人工问题拼接，训练一个文本分类模型。在验证集和测试集上，使用该模型对所有的自然语言问题-人工问题对进行打分。）
